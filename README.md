![OneScriptDB](https://github.com/vasvl123/OneScriptDB/blob/master/resource/osdb.png "OneScriptDB")

# OneScriptDB

[![Join the chat at https://gitter.im/OneScriptDB/Lobby](https://badges.gitter.im/OneScriptDB/Lobby.svg)](https://gitter.im/OneScriptDB/Lobby?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge&utm_content=badge)

Платформа для разработки web-приложений в среде OneScript.


## Структура

1. Модуль веб-сервера (webserver.os) Обработка запросов пользователя, связь с процессами, обращение к объектам БД.
2. Модуль сеанса пользователя (showdata.os) Обработка запросов пользователя, редактор структуры данных.
3. Модуль обработки узлов структуры данных (pagedata.os) Формирование интерфейса, интерпретатор структуры данных.
4. Модуль работы с контейнерами файлов данных (dbaccess.os)
5. Библиотеки подключаемых функций, операторов.


## Описание

OneScriptDB задумана как простой и удобный инструмент для решения задач хранения и управления данными. На базе платформы можно построить любое web-приложение как для индивидуального пользования, так и для совместной работы в многопользовательском режиме в локальной сети и через интернет.

Все данные хранятся в текстовых файлах, где каждая строка хранит один узел DOM. Свойства узлов хранятся в виде пары ключ - значение, разделенные символом табуляции. Код узла соответствует номеру строки в файле. Узел загружается в память в виде структуры, содержащей стандартные свойства: Код, Имя, Значение, и ссылки на другие узлы: Соседний, Дочерний, Атрибут, Старший, Родитель; структура временных значений Состояние.

Текстовые файлы с данными могут быть частью файла контейнера [имя БД].osdb, в котором файлу с данными присваивается имя, соответствующее его позиции в контейнере. Вместе с файлом в контейнере сохраняется заголовок файла, который может хранить произвольную информацию об этом файле. Файлы, извлеченные из контейнера сохраняются в одноименную вложенную папку [Имя БД].files. Не входящие в состав ни одного контейнера файлы хранятся в папке data\.files.

Платформа имеет собственный веб-сервер (модуль webserver.os) - однопоточный, но позволяющий работать в многопользовательском режиме благодаря перенаправлению запросов пользователей отдельным процессам (модуль showdata.os). В качестве параметра при запуске сервера можно указать порт сервера, по умолчанию используется порт 8888.

Модуль процесса пользователя (showdata.os) хранит текущее состояние приложения, производит обработку запросов пользователя, содержит редактор структуры данных. Редактор запускается в отдельном окне из главного меню программы. Для изменения структуры данных нужно выбрать нужный узел и выполнить с ним действия. Узлы можно создавать, удалять, копировать, вырезать и вставлять, изменять имя и значение. Имя узла - его тип - определяет, как он будет обрабатываться внутренним интерпретатором (в модуле pagedata.os).

Интерпретатор формирует представление данных для отображения в браузере. Каждый узел, в зависимости от его имени обрабатывается интерпретатором по разному. У (Узел) - шаблон для дальнейшего использования. Э (Элемент) - обновляемый элемент интерфейса. О (Оператор) - выполняет действие над вложенными узлами. Ф(Функция) - вызывает функцию из подключаемой библиотеки. Результат работы функции записывается во вложенный узел и интерпретируется. К (Копия) - создает копию узла (У). С (Ссылка) - передает ссылку (структуру) узла (У). З (Значение) - интерпретирует значение узла(У) или присваивает значение (если есть дочерний узел) узлу (У). Свойство - передает значение свойства ссылки (структуры) , Атрибут - передает значение атрибута узла. Первый, Соседний - получает ссылку (структуру) текущего или соседнего узла. Истина, Ложь, Неопределенно, Пустой, Число, Строка - передает соответствующее значение. Теги HTML передаются в виде HTML разметки.

Действия пользователя из браузера передаются серверу в виде get-запросов, а сформированный ответ (в виде обычного HTML) загружаются в определенный (по идентификатору) узел DOM страницы браузера. Для работы с DOM на стороне клиента используется библиотека JQuery. В качестве шаблона для графического интерфейса используется CoreUI и BootStrap 4. Шаблоны интерфейса(howdata.html), CSS стили и скрипты JS находятся в каталоге resources.


## Текущие задачи
1. Доработка редактора структуры данных.
2. Доработка интерпретатора структуры данных.
3. Разработка подключаемых библиотек для основных элементов интерфейса.
4. Разработка сайта проекта.


Адрес тестового сервера: http://vasvl123.github.io/OneScriptDB
