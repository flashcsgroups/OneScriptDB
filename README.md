![OneScriptDB](https://github.com/vasvl123/OneScriptDB/blob/master/resource/osdb.png "OneScriptDB")

# OneScriptDB

[![Join the chat at https://gitter.im/OneScriptDB/Lobby](https://badges.gitter.im/OneScriptDB/Lobby.svg)](https://gitter.im/OneScriptDB/Lobby?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge&utm_content=badge)

Платформа для разработки web-приложений в среде OneScript.

## Цель и задачи проекта

Цель проекта - разработка системы управления знаниями, основанной на онтологической базе данных.

На текущий момент уже реализованы средства хранения, представления и управления структурами данных.
Начата разработка средств интерпретации данных, представленных в формализованном виде (онтологии).

## Структура

1. Модуль запуска приложения и управления процессами (starter.os).
2. Модуль веб-сервера (webserver.os).
3. Модуль интерфейса пользователя (showdata.os) Контроллер сессии, редактор структуры данных.
4. Модуль интерпретации структуры данных (pagedata.os).
5. Модуль сервера данных (dataserver.os) Асинхронная обработка запросов к данным.
6. Модуль работы с контейнерами файлов данных (dbaccess.os)
7. Библиотеки подключаемых функций, операторов (/lib/Операторы.os, /lib/Системные.os).

Адрес тестового сервера: http://vasvl123.github.io/OneScriptDB Имя/пароль - admin/admin

Для локального запуска на своем компьютере необходимо:
Скачать этот репозиторий к себе на диск.
Скачать и установить последнюю версию OneScript http://oscript.io/downloads
Установить библиотеку .Net версии не ниже 4.5 - для Windows, а для linux mono-complete не ниже 5.2.
Перейти в папку OneScriptDB и выполнить команду: oscript starter.os

## Описание

Платформа OneScriptDB задумана как простой и удобный инструмент для решения задач хранения и управления данными. Платформа является фреймворком, написаном на 1С-подобном языке для исполнения в среде OneScript. Фреймворк использует механизм полностью серверного рендеринга интерфейса, что значительно упрощает разработку. На базе платформы можно построить любое web-приложение как для индивидуального пользования, так и для совместной работы в многопользовательском режиме в локальной сети и через интернет.

Все данные хранятся в текстовых файлах, где каждая строка хранит один узел DOM. Свойства узлов хранятся в виде пары ключ - значение, разделенные символом табуляции. Код узла соответствует номеру строки в файле. Узел загружается в память в виде структуры, содержащей стандартные свойства: Код, Имя, Значение, и ссылки на другие узлы: Соседний, Дочерний, Атрибут, Старший, Родитель; а также структура временных значений Состояние.

Текстовые файлы хранятся в файле контейнера [имя БД].osdb. Вместе с файлом в контейнере сохраняется заголовок файла, который может хранить произвольную информацию об этом файле. Не входящие в состав ни одного контейнера файлы хранятся в папке data\.files.

Платформа имеет собственный веб-сервер (модуль webserver.os) - однопоточный, но позволяющий работать в многопользовательском режиме благодаря перенаправлению запросов пользователей отдельным процессам (модуль showdata.os). В качестве параметра при запуске сервера можно указать порт сервера, по умолчанию используется порт 8888.

Доступ к файлам данных осуществляется через отдельный процесс - сервер данных (dataserver.os). Сервер обрабатывает запросы ассинхронно, отдавая результаты по ходу выполнения запросов.

Модуль процесса пользователя (showdata.os) хранит текущее состояние приложения, производит обработку запросов пользователя, содержит редактор структуры данных. Редактор запускается в отдельном окне из главного меню программы. Для изменения структуры данных нужно выбрать нужный узел и выполнить с ним действия. Узлы можно создавать, удалять, копировать, вырезать и вставлять, изменять имя и значение. Имя узла - его тип - определяет, как он будет обрабатываться внутренним интерпретатором (в модуле pagedata.os).

Интерпретатор формирует представление данных для отображения в браузере. Каждый узел, в зависимости от его имени обрабатывается интерпретатором по разному. У (Узел) - присваивает имя подчиненной структуре данных. Э (Элемент) - отображает обновляемый элемент интерфейса. О (Оператор) - выполняет действие над вложенными узлами. Ф(Функция) - вызывает функцию из подключаемой библиотеки, аргументами являются атрибуты узла: А (Аргумент). Результат работы функции отображается как подчиненный узел и интерпретируется. К (Копия) - создает копию узла (У). С (Ссылка) - передает ссылку на подчиненный узел либо именованный узел (У). З (Значение) - интерпретирует значение узла(У). П (Пусть) - присваивает значение (копирует дочерний узел) узлу (У). Указатель - передает ссылку на узел по коду узла. Свойство - получает значение свойства ссылки (структуры) , Атрибут - получает значение атрибута узла. Первый, Соседний - передает ссылку на текущий или соседний узел. Истина, Ложь, Неопределенно, Пустой, Число, Строка - передает соответствующее значение. Теги HTML передаются в виде HTML разметки.

Действия пользователя из браузера передаются серверу в виде get-запросов, а сформированный ответ (в виде обычного HTML) загружается в определяемый идентификатором узел DOM страницы браузера. Для работы с DOM на стороне клиента используется библиотека JQuery. В качестве шаблона для графического интерфейса используется CoreUI и BootStrap 4. Шаблоны интерфейса(howdata.html), CSS стили и скрипты JS находятся в каталоге resources.

Реализовано два режима работы платформы: многостраничный - для гостевого режима, и одностраничный (панель разработчика) - для авторизованного. Реализована форма безопасной авторизации, механизм регистрации новых пользователей.

Если это тоже кому-то интересно, буду рад участию и признателен за подсказки, если таковые вы сможете мне дать.
